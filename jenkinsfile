pipeline {
    agent any
    
    stages {
        stage('Compilación') {
            steps {
                // Obtener el código fuente del repositorio utilizando Git
                git credentialsId: 'nombre-de-las-credenciales', url: 'https://github.com/javieralmeida30/TestingProject.git'
                
                // Instalar dependencias utilizando Maven
                sh 'mvn clean install'
            }
        }
        
        stage('Pruebas') {
            steps {
                // Ejecutar pruebas unitarias utilizando Maven
                sh 'mvn test'
                
                // Ejecutar pruebas de integración utilizando Docker Compose
                sh 'docker-compose -f docker-compose.test.yml up --abort-on-container-exit'
            }
        }
        
        stage('Empaquetado') {
            steps {
                // Construir una imagen Docker de la aplicación
                sh 'docker build -t tu-app:latest .'
                
                // Publicar la imagen Docker en un registro de contenedores
                sh 'docker push tu-registry/tu-app:latest'
            }
        }
        
        stage('Despliegue') {
            steps {
                // Implementar la aplicación en un entorno de producción utilizando Kubernetes
                sh 'kubectl apply -f tu-archivo-deploy.yml'
            }
        }
    }
}
